# TRYREST

## Описание проекта
TRYREST — это веб-приложение, разработанное на языке программирования Go, которое предоставляет функционал для управления бронированиями, пользователями и событиями. Приложение использует архитектуру REST API и поддерживает Graceful Shutdown для корректного завершения работы сервера.

## Стек технологий
- **Язык программирования**: Go
- **Веб-сервер**: Встроенный HTTP-сервер Go
- **База данных**: PostgreSQL
- **Миграции базы данных**: SQL-скрипты
- **Логирование**: Пакет `slog` с кастомной реализацией логгера
- **Docker**: Используется для контейнеризации приложения и базы данных
- **Конфигурация**: YAML-файлы

## Архитектура
- **cmd/booker/main.go**: Точка входа в приложение. Здесь происходит инициализация конфигурации, логгера и сервера.
- **internal/handlers**: Содержит обработчики (handlers) для различных эндпоинтов.
- **internal/storage/postgre**: Логика взаимодействия с базой данных PostgreSQL.
- **config/local.yaml**: Конфигурационный файл для локальной среды.
- **docker-compose.yaml**: Описание сервисов для запуска приложения и базы данных в Docker.

## Эндпоинты
Приложение предоставляет следующие эндпоинты:
- **/users**: Управление пользователями. Позволяет создавать, обновлять, удалять и получать информацию о пользователях.
- **/events**: Управление событиями. Позволяет создавать, обновлять, удалять и получать информацию о событиях.
- **/bookings**: Управление бронированиями. Позволяет создавать, обновлять, удалять и получать информацию о бронированиях.

## Обработчики (Handlers)
Обработчики реализованы в пакете `internal/handlers` и разделены на три основные группы:
- **UserHandler**: Отвечает за обработку запросов, связанных с пользователями. Эндпоинты включают создание нового пользователя, получение информации о пользователе, обновление данных пользователя и удаление пользователя.
- **EventHandler**: Отвечает за обработку запросов, связанных с событиями. Эндпоинты включают создание нового события, получение информации о событии, обновление данных события и удаление события.
- **BookingHandler**: Отвечает за обработку запросов, связанных с бронированиями. Эндпоинты включают создание нового бронирования, получение информации о бронировании, обновление данных бронирования и удаление бронирования.

## Docker
Для запуска приложения используется Docker. Основные компоненты:
- **PostgreSQL**: Контейнер с базой данных PostgreSQL. Конфигурация задаётся в `docker-compose.yaml`.
- **Приложение**: Контейнер с приложением, который зависит от базы данных.
- **Миграции**: Контейнер для выполнения миграций базы данных.

### Команды для работы с Docker
1. Запуск всех сервисов:
   ```bash
   docker-compose up
   ```
2. Остановка всех сервисов:
   ```bash
   docker-compose down
   ```
3. Просмотр логов:
   ```bash
   docker-compose logs
   ```
4. Повторный запуск с пересборкой контейнеров:
   ```bash
   docker-compose up --build
   ```

## Конфигурация
Конфигурация приложения задаётся в файле `config/local.yaml`:
```yaml
env: "local" # local, development, production
storage_path: "postgres://adb:password@localhost:6538/pet?sslmode=disable"
http_server:
  address: "localhost:8080"
  timeout: 4s
  idle_timeout: 60s
```

## Как запустить
1. Убедитесь, что у вас установлен Docker и Docker Compose.
2. Склонируйте репозиторий:
   ```bash
   git clone <URL>
   ```
3. Перейдите в директорию проекта и запустите Docker Compose:
   ```bash
   docker-compose up
   ```
4. Приложение будет доступно по адресу `http://localhost:8080`.

## Лицензия
Этот проект распространяется под лицензией MIT.
